<Window x:Class="MasrPrinter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MasrPrinter - Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯" 
        Height="700" Width="1350"
        MinHeight="600" MinWidth="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal"
        FlowDirection="RightToLeft"
        Background="#F5F5F5">
    
    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Background" Value="#6366F1"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="FontSize" Value="15"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#4F46E5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#10B981"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#059669"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#6366F1" Padding="20,12">
            <StackPanel>
                <TextBlock Text="ðŸ–¨ï¸ MasrPrinter" 
                          FontSize="26" 
                          FontWeight="Bold" 
                          Foreground="White"
                          HorizontalAlignment="Center"/>
                <TextBlock Text="Ù†Ø¸Ø§Ù… Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ - ÙƒÙ„ Ø´ÙŠØ¡ ÙÙŠ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø©" 
                          FontSize="12" 
                          Foreground="#E0E7FF"
                          HorizontalAlignment="Center"
                          Margin="0,3,0,0"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto" Padding="15">
            <StackPanel MaxWidth="1300">
                
                <!-- Settings Section -->
                <Expander Header="âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" IsExpanded="True" Margin="0,0,0,10" FontSize="15" FontWeight="Bold">
                    <Border Background="White" CornerRadius="8" Padding="15" Margin="0,8,0,0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Column 1 -->
                            <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                <TextBlock Text="Ø§Ù„Ø·Ø§Ø¨Ø¹Ø©:" FontWeight="Bold" FontSize="13" Margin="0,0,0,5"/>
                                <ComboBox x:Name="PrinterComboBox" Height="35" FontSize="14" Margin="0,0,0,12"/>

                                <TextBlock Text="Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ±Ù‚ (Ù…Ù…):" FontWeight="Bold" FontSize="13" Margin="0,0,0,5"/>
                                <TextBox x:Name="PaperWidthTextBox" Height="35" FontSize="14" Margin="0,0,0,12" TextChanged="PaperSize_TextChanged"/>

                                <TextBlock Text="Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ÙˆØ±Ù‚ (Ù…Ù…):" FontWeight="Bold" FontSize="13" Margin="0,0,0,5"/>
                                <TextBox x:Name="PaperHeightTextBox" Height="35" FontSize="14" Margin="0,0,0,12" TextChanged="PaperSize_TextChanged"/>

                                <TextBlock Text="Ø¬ÙˆØ¯Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (DPI):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider x:Name="BarcodeQualitySlider" Minimum="150" Maximum="600" Value="300" TickFrequency="50" Grid.Column="0" Height="30"/>
                                    <TextBlock Text="{Binding ElementName=BarcodeQualitySlider, Path=Value, StringFormat={}{0:0}}" 
                                              FontWeight="Bold" FontSize="15" Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center"/>
                                </Grid>

                                <CheckBox x:Name="Enable2x1CheckBox" Content="ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ 2x1 (Ø±Ù‚Ù… ÙÙˆÙ‚ + Ø¨Ø§Ø±ÙƒÙˆØ¯ ØªØ­Øª)" 
                                         FontWeight="Bold" FontSize="14" Margin="0,0,0,20"/>

                                <TextBlock Text="Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ø­Ø±Ø§Ø±ÙŠØ©:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <Grid Margin="0,0,0,20">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Slider x:Name="ThermalLevelSlider" Minimum="0" Maximum="100" Value="50" TickFrequency="10" Grid.Column="0" Height="30"/>
                                    <TextBlock Text="{Binding ElementName=ThermalLevelSlider, Path=Value, StringFormat={}{0:0}}" 
                                              FontWeight="Bold" FontSize="15" Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center"/>
                                </Grid>

                                <TextBlock Text="Ø­Ø¬Ù… Ø§Ù„Ù†Øµ:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="TextSizeTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø­Ø¬Ù… Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="BarcodeSizeTextBox" Height="40" FontSize="15" Margin="0,0,0,0"/>
                            </StackPanel>

                            <!-- Column 2 -->
                            <StackPanel Grid.Column="1" Margin="20,0,0,0">
                                <TextBlock Text="Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ X (Ù…Ù…):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="BarcodePositionXTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Y (Ù…Ù…):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="BarcodePositionYTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (Ù…Ù…):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="BarcodeHeightTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (Ù…Ù…):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="BarcodeWidthTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø­Ø¬Ù… Ø®Ø· Ø§Ù„Ø±Ù‚Ù…:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="NumberFontSizeTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø­Ø¬Ù… Ø®Ø· #:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="HashtagFontSizeTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø· Ø§Ù„Ø¶ÙŠÙ‚ (Narrow):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="NarrowBarWidthTextBox" Height="40" FontSize="15" Margin="0,0,0,20"/>

                                <TextBlock Text="Ø¹Ø±Ø¶ Ø§Ù„Ø®Ø· Ø§Ù„Ø¹Ø±ÙŠØ¶ (Wide):" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                <TextBox x:Name="WideBarWidthTextBox" Height="40" FontSize="15" Margin="0,0,0,0"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Expander>

                <!-- Print Mode Selection -->
                <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="ðŸ“‹ Ù†ÙˆØ¹ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                            <RadioButton x:Name="BatchModeRadio" Content="Ø·Ø¨Ø§Ø¹Ø© Ù…ØªØ³Ù„Ø³Ù„Ø©" 
                                        FontSize="15" IsChecked="True" Margin="0,0,30,0" 
                                        Checked="PrintMode_Changed"/>
                            <RadioButton x:Name="CustomModeRadio" Content="Ø·Ø¨Ø§Ø¹Ø© Ù…Ø®ØµØµØ©" 
                                        FontSize="15" Checked="PrintMode_Changed"/>
                        </StackPanel>

                        <!-- Batch Print Panel -->
                        <StackPanel x:Name="BatchPrintPanel" Visibility="Visible">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                    <TextBlock Text="Ø±Ù‚Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                    <TextBox x:Name="StartNumberTextBox" Height="40" FontSize="15"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="15,0,15,0">
                                    <TextBlock Text="Ø±Ù‚Ù… Ø§Ù„Ù†Ù‡Ø§ÙŠØ©:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                    <TextBox x:Name="EndNumberTextBox" Height="40" FontSize="15"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="15,0,0,0">
                                    <TextBlock Text="Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                    <ComboBox x:Name="BatchBarcodeTypeComboBox" Height="40" FontSize="15" SelectedIndex="0">
                                        <ComboBoxItem Content="Code128"/>
                                        <ComboBoxItem Content="QR Code"/>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>
                        </StackPanel>

                        <!-- Custom Print Panel -->
                        <StackPanel x:Name="CustomPrintPanel" Visibility="Collapsed">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="2*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="0,0,15,0">
                                    <TextBlock Text="Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø®ØµØµ:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                    <TextBox x:Name="CustomTextBox" Height="40" FontSize="15" TextChanged="CustomText_Changed"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="15,0,0,0">
                                    <TextBlock Text="Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯:" FontWeight="Bold" FontSize="14" Margin="0,0,0,8"/>
                                    <ComboBox x:Name="CustomBarcodeTypeComboBox" Height="40" FontSize="15" SelectedIndex="0" SelectionChanged="CustomBarcodeType_Changed">
                                        <ComboBoxItem Content="Code128"/>
                                        <ComboBoxItem Content="QR Code"/>
                                    </ComboBox>
                                </StackPanel>
                            </Grid>

                            <CheckBox x:Name="WithBarcodeCheckBox" Content="Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¹ Ø¨Ø§Ø±ÙƒÙˆØ¯" 
                                     FontWeight="Bold" Margin="0,15,0,0" IsChecked="True" 
                                     Checked="WithBarcode_Changed" Unchecked="WithBarcode_Changed"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Preview Section -->
                <Border Background="White" CornerRadius="8" Padding="20" Margin="0,0,0,15">
                    <StackPanel>
                        <TextBlock Text="ðŸ‘ï¸ Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø¨Ø§Ø´Ø±Ø©" FontSize="20" FontWeight="Bold" Margin="0,0,0,15"/>
                        
                        <Border Background="#F9FAFB" BorderBrush="#E5E7EB" BorderThickness="2" 
                               CornerRadius="8" Height="250" Padding="15">
                            <Grid>
                                <TextBlock x:Name="PreviewPlaceholder" 
                                          Text="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©"
                                          FontSize="16" 
                                          Foreground="#9CA3AF"
                                          HorizontalAlignment="Center" 
                                          VerticalAlignment="Center"/>
                                <Image x:Name="PreviewImage" Stretch="Uniform"/>
                            </Grid>
                        </Border>

                        <Button Content="ðŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©" 
                               Click="UpdatePreview_Click" 
                               Margin="0,15,0,0" 
                               Height="40"/>
                    </StackPanel>
                </Border>

                <!-- Action Buttons -->
                <Grid Margin="0,0,0,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Content="ðŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" 
                           Click="SaveSettings_Click" 
                           Height="45" 
                           Margin="0,0,8,0"/>

                    <Button Grid.Column="1" Content="ðŸ“¥ Ø­ÙØ¸ PNG" 
                           Click="SavePNG_Click" 
                           Height="45" 
                           Margin="8,0,8,0"
                           Background="#F59E0B">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
                                <Setter Property="Background" Value="#F59E0B"/>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#D97706"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Button Grid.Column="2" Content="ðŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©" 
                           Click="Print_Click" 
                           Style="{StaticResource SuccessButton}"
                           Height="45" 
                           Margin="8,0,0,0"/>
                </Grid>

                <!-- Progress Bar -->
                <Border Background="White" CornerRadius="8" Padding="15" Margin="0,0,0,0">
                    <StackPanel>
                        <TextBlock x:Name="ProgressText" 
                                  Text="Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©" 
                                  FontSize="14" 
                                  FontWeight="Bold" 
                                  HorizontalAlignment="Center" 
                                  Margin="0,0,0,10"/>
                        <ProgressBar x:Name="PrintProgressBar" 
                                    Height="25" 
                                    Minimum="0" 
                                    Maximum="100" 
                                    Value="0"/>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
