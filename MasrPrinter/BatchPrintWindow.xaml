<Window x:Class="MasrPrinter.BatchPrintWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="طباعة متسلسلة" 
        Height="650" Width="900"
        WindowStartupLocation="CenterOwner"
        FlowDirection="RightToLeft"
        Background="{StaticResource BackgroundColor}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{StaticResource PrimaryColor}" Padding="20">
            <TextBlock Text="📦 طباعة متسلسلة" 
                       FontSize="28" 
                       FontWeight="Bold" 
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="30">
                <Border Style="{StaticResource CardPanel}" Margin="0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="إعدادات الطباعة" Style="{StaticResource SubtitleText}"/>
                            
                            <TextBlock Text="من رقم:" Style="{StaticResource LabelText}"/>
                            <TextBox x:Name="StartNumberTextBox" 
                                     Text="1" 
                                     Style="{StaticResource ModernTextBox}"/>

                            <TextBlock Text="إلى رقم:" Style="{StaticResource LabelText}"/>
                            <TextBox x:Name="EndNumberTextBox" 
                                     Text="50" 
                                     Style="{StaticResource ModernTextBox}"/>

                            <TextBlock Text="نوع الباركود:" Style="{StaticResource LabelText}"/>
                            <ComboBox x:Name="BarcodeTypeComboBox" 
                                      Style="{StaticResource ModernComboBox}"
                                      SelectedIndex="0"
                                      SelectionChanged="BarcodeTypeComboBox_SelectionChanged">
                                <ComboBoxItem Content="Code 128 (خطي)"/>
                                <ComboBoxItem Content="QR Code (ثنائي الأبعاد)"/>
                            </ComboBox>

                            <Button Content="🔄 معاينة" 
                                    Style="{StaticResource ModernButton}"
                                    Click="PreviewButton_Click"
                                    Margin="10,20,10,10"/>
                        </StackPanel>

                        <StackPanel Grid.Column="2">
                            <TextBlock Text="معاينة" Style="{StaticResource SubtitleText}"/>
                            <Border BorderBrush="{StaticResource BorderColor}" 
                                    BorderThickness="2" 
                                    CornerRadius="8" 
                                    Padding="20"
                                    Background="White"
                                    Margin="10"
                                    Height="300">
                                <Image x:Name="PreviewImage" 
                                       Stretch="Uniform"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                            </Border>
                            
                            <TextBlock x:Name="PreviewInfoText" 
                                       Text="اضغط 'معاينة' لرؤية العينة" 
                                       Style="{StaticResource BodyText}"
                                       HorizontalAlignment="Center"
                                       Foreground="{StaticResource SecondaryTextColor}"/>
                        </StackPanel>
                    </Grid>
                </Border>

                <Border Style="{StaticResource CardPanel}" Margin="0,20,0,0">
                    <StackPanel>
                        <TextBlock Text="حالة الطباعة" Style="{StaticResource SubtitleText}"/>
                        <ProgressBar x:Name="PrintProgressBar" 
                                     Height="30" 
                                     Margin="10"
                                     Foreground="{StaticResource SuccessColor}"/>
                        <TextBlock x:Name="ProgressText" 
                                   Text="جاهز للطباعة" 
                                   Style="{StaticResource BodyText}"
                                   HorizontalAlignment="Center"
                                   Foreground="{StaticResource PrimaryColor}"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="2" Background="White" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0" Padding="20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        Content="🖨️ بدء الطباعة"
                        Click="PrintButton_Click"
                        Height="50"
                        FontSize="18">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ModernButton}">
                            <Setter Property="Background" Value="{StaticResource SuccessColor}"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#43A047"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>

                <Button Grid.Column="1"
                        Content="إغلاق"
                        Click="CloseButton_Click"
                        Height="50"
                        FontSize="18">
                    <Button.Style>
                        <Style TargetType="Button" BasedOn="{StaticResource ModernButton}">
                            <Setter Property="Background" Value="{StaticResource SecondaryTextColor}"/>
                            <Style.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter Property="Background" Value="#616161"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>
