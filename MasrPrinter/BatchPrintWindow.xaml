<Window x:Class="MasrPrinter.BatchPrintWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="طباعة متسلسلة" 
        Height="700" Width="1000"
        WindowStartupLocation="CenterOwner"
        FlowDirection="RightToLeft"
        Background="{StaticResource BackgroundGradient}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Background="{StaticResource PrimaryGradient}" Padding="32,24">
            <Border.Effect>
                <DropShadowEffect Color="#6366F1" Opacity="0.4" BlurRadius="30" ShadowDepth="8" Direction="270"/>
            </Border.Effect>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Viewbox Width="40" Height="40" Margin="0,0,16,0">
                    <Canvas Width="24" Height="24">
                        <Path Fill="White" Data="M3,3H11V11H3V3M13,3H21V11H13V3M3,13H11V21H3V13M18,13H21V16H18V13M16,18H19V21H16V18M13,16H16V19H13V16M18,18H21V21H18V18Z"/>
                    </Canvas>
                </Viewbox>
                <TextBlock Text="📦 طباعة متسلسلة" 
                           FontSize="32" 
                           FontWeight="Bold" 
                           Foreground="White"
                           VerticalAlignment="Center">
                    <TextBlock.Effect>
                        <DropShadowEffect Color="#000000" Opacity="0.2" BlurRadius="8" ShadowDepth="2"/>
                    </TextBlock.Effect>
                </TextBlock>
            </StackPanel>
        </Border>

        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <Grid Margin="32,24">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="1.2*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <Border Style="{StaticResource CardPanel}" Margin="16,0">
                        <StackPanel>
                            <Border Background="{StaticResource PrimaryGradient}" 
                                    CornerRadius="14" 
                                    Padding="16,10" 
                                    Margin="0,0,0,20">
                                <TextBlock Text="⚙️ إعدادات الطباعة" 
                                          FontSize="20" 
                                          FontWeight="Bold" 
                                          Foreground="White"/>
                            </Border>
                            
                            <TextBlock Text="من رقم:" 
                                      FontSize="14" 
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource SecondaryTextColor}"
                                      Margin="10,8,10,8"/>
                            <TextBox x:Name="StartNumberTextBox" 
                                     Text="1" 
                                     Style="{StaticResource ModernTextBox}"
                                     FontSize="18"
                                     Height="50"/>

                            <TextBlock Text="إلى رقم:" 
                                      FontSize="14" 
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource SecondaryTextColor}"
                                      Margin="10,16,10,8"/>
                            <TextBox x:Name="EndNumberTextBox" 
                                     Text="50" 
                                     Style="{StaticResource ModernTextBox}"
                                     FontSize="18"
                                     Height="50"/>

                            <TextBlock Text="نوع الباركود:" 
                                      FontSize="14" 
                                      FontWeight="SemiBold"
                                      Foreground="{StaticResource SecondaryTextColor}"
                                      Margin="10,16,10,8"/>
                            <ComboBox x:Name="BarcodeTypeComboBox" 
                                      Style="{StaticResource ModernComboBox}"
                                      SelectedIndex="0"
                                      SelectionChanged="BarcodeTypeComboBox_SelectionChanged"
                                      Height="50">
                                <ComboBoxItem Content="Code 128 (خطي)" FontSize="15"/>
                                <ComboBoxItem Content="QR Code (ثنائي الأبعاد)" FontSize="15"/>
                            </ComboBox>

                            <Button Content="🔄 معاينة" 
                                    Style="{StaticResource ModernButton}"
                                    Click="PreviewButton_Click"
                                    Margin="10,24,10,10"
                                    Height="48"/>
                        </StackPanel>
                    </Border>
                    
                    <Border Style="{StaticResource CardPanel}" Margin="16,16,16,0">
                        <StackPanel>
                            <Border Background="{StaticResource SuccessGradient}" 
                                    CornerRadius="14" 
                                    Padding="16,10" 
                                    Margin="0,0,0,16">
                                <TextBlock Text="📊 حالة الطباعة" 
                                          FontSize="18" 
                                          FontWeight="Bold" 
                                          Foreground="White"/>
                            </Border>
                            
                            <ProgressBar x:Name="PrintProgressBar" 
                                         Height="36" 
                                         Margin="0,8"
                                         Foreground="{StaticResource SuccessGradient}"
                                         Background="{StaticResource BackgroundColor}"
                                         BorderThickness="0"/>
                            <TextBlock x:Name="ProgressText" 
                                       Text="جاهز للطباعة" 
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       HorizontalAlignment="Center"
                                       Foreground="{StaticResource PrimaryColor}"
                                       Margin="0,12,0,0"/>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <Border Grid.Column="2" Style="{StaticResource CardPanel}">
                    <StackPanel>
                        <Border Background="{StaticResource AccentGradient}" 
                                CornerRadius="14" 
                                Padding="16,10" 
                                Margin="0,0,0,20">
                            <TextBlock Text="👁️ معاينة" 
                                      FontSize="20" 
                                      FontWeight="Bold" 
                                      Foreground="White"/>
                        </Border>
                        
                        <Border BorderBrush="{StaticResource AccentColor}" 
                                BorderThickness="3" 
                                CornerRadius="16" 
                                Padding="20"
                                Background="White"
                                Height="340">
                            <Border.Effect>
                                <DropShadowEffect Color="#EC4899" Opacity="0.1" BlurRadius="20" ShadowDepth="0"/>
                            </Border.Effect>
                            <Image x:Name="PreviewImage" 
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"/>
                        </Border>
                        
                        <TextBlock x:Name="PreviewInfoText" 
                                   Text="اضغط 'معاينة' لرؤية العينة" 
                                   FontSize="15"
                                   FontWeight="SemiBold"
                                   HorizontalAlignment="Center"
                                   Foreground="{StaticResource SecondaryTextColor}"
                                   Margin="0,16,0,0"/>
                        
                        <Border Background="#FEF3C7" 
                                CornerRadius="12" 
                                Padding="16" 
                                Margin="0,20,0,0"
                                BorderBrush="{StaticResource WarningColor}"
                                BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="💡 ملاحظة هامة" 
                                          FontWeight="Bold" 
                                          Foreground="{StaticResource WarningColor}" 
                                          FontSize="14"
                                          Margin="0,0,0,8"/>
                                <TextBlock Text="سيتم طباعة جميع الأرقام من البداية إلى النهاية تلقائياً" 
                                          Foreground="{StaticResource TextColor}" 
                                          FontSize="13" 
                                          TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>

        <Border Grid.Row="2" Background="White" BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0" Padding="32,20">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Opacity="0.05" BlurRadius="20" ShadowDepth="0" Direction="90"/>
            </Border.Effect>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        Content="🖨️ بدء الطباعة"
                        Style="{StaticResource SuccessButton}"
                        Click="PrintButton_Click"
                        Height="56"
                        FontSize="18"/>

                <Button Grid.Column="2"
                        Content="إغلاق"
                        Style="{StaticResource SecondaryButton}"
                        Click="CloseButton_Click"
                        Height="56"
                        FontSize="18"/>
            </Grid>
        </Border>
    </Grid>
</Window>
